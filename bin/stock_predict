#!/usr/bin/env python
import os
os.environ['TF_CPP_MIN_LOG_LEVEL']='2'
import datetime
import logging
import time
from future.model.cnn_three_mean import ThreeMeanStockModel
from future.model.cnn_one_mean import OneMeanStockModel
from future.stock.stock import set_buy_list, get_buy_list
import pandas as pd
from future.utils.config import get_config
import os.path
result_path = get_config('path', 'results')
print(result_path)
date = '2017-09-27'
result = {}
print("Predict Stock at " + date)
# Model Three
print("=========================================================")
print("MODEL THREE HISTORY MEAN")
model = ThreeMeanStockModel()
for r in model.predict(date):
    result.update(r)

#Model 1
print("=========================================================")
print("MODEL ONE HISTORY MEAN")
model = OneMeanStockModel()
for r in model.predict(date):
    result.update(r)
df = pd.DataFrame.from_dict(result)

down_cols = [col for col in df.columns if col.startswith('0')]
df['down'] = df[down_cols].sum(axis=1)

up_cols = [col for col in df.columns if col.startswith('2')]
df['up'] = df[up_cols].sum(axis=1)

print(result_path)
df.to_csv(os.path.join(result_path, '%s.csv' % (date)), index=True)
